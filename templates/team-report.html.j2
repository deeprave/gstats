{#
  TEMPLATE: Team Analysis Dashboard (HTML)
  BEST FOR: gstats commits
  USAGE: gstats commits --template templates/team-report.html.j2 --output team-report.html
  OUTPUT: Visual HTML dashboard with styled charts and team productivity metrics
  SUPPORTS: --all, --output-limit flags
  NOTE: Open the generated .html file in a web browser to view
#}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Analysis Report - {{ repository.name }}</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            margin: 0; 
            padding: 40px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            padding: 40px; 
            border-radius: 12px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        }
        h1 { 
            color: #2d3748; 
            border-bottom: 3px solid #667eea; 
            padding-bottom: 15px; 
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        h2 { 
            color: #4a5568; 
            margin-top: 40px; 
            font-size: 1.8em;
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }
        .overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            display: block;
        }
        .stat-label {
            color: #718096;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 0.5px;
        }
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 20px 0; 
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        th, td { 
            border: none;
            padding: 15px 12px; 
            text-align: left; 
        }
        th { 
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }
        tr:nth-child(even) { 
            background-color: #f8fafc; 
        }
        tr:hover {
            background-color: #edf2f7;
        }
        .highlight { 
            background: linear-gradient(135deg, #fed7d7, #feb2b2) !important;
            color: #c53030;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }
        .meta-info {
            background: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Team Analysis Report</h1>
        
        <div class="meta-info">
            <strong>Repository:</strong> {{ repository.name }}<br>
            <strong>Analysis Date:</strong> {{ repository.scan_timestamp | date(format="%Y-%m-%d %H:%M UTC") }}<br>
            {% if project %}<strong>Project:</strong> {{ project }}<br>{% endif %}
            {% if date %}<strong>Report Period:</strong> {{ date }}<br>{% endif %}
        </div>

        <h2>Project Overview</h2>
        <div class="overview">
            <div class="stat-card">
                <span class="stat-number">{{ statistics.total_commits | number_format }}</span>
                <span class="stat-label">Total Commits</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ authors.total_authors | number_format }}</span>
                <span class="stat-label">Contributors</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ files.total_files | number_format }}</span>
                <span class="stat-label">Files Modified</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ (statistics.total_commits / authors.total_authors) | round(precision=1) }}</span>
                <span class="stat-label">Avg Commits/Author</span>
            </div>
        </div>

        <h2>Team Contribution Analysis</h2>
        <table>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Contributor</th>
                    <th>Commits</th>
                    <th>Contribution %</th>
                    <th>Activity</th>
                </tr>
            </thead>
            <tbody>
                {% for author in authors.list %}
                <tr {% if loop.index == 1 %}class="highlight"{% endif %}>
                    <td><strong>{{ loop.index }}</strong></td>
                    <td>{{ author.name }}</td>
                    <td>{{ author.commits | number_format }}</td>
                    <td>{{ author.percentage | round(precision=1) }}%</td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{ author.percentage }}%"></div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>Most Active Files</h2>
        <table>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>File Path</th>
                    <th>Commits</th>
                    <th>Lines Added</th>
                    <th>Lines Removed</th>
                    <th>Net Change</th>
                </tr>
            </thead>
            <tbody>
                {% for file in files.top_by_commits | slice(end=15) %}
                <tr>
                    <td><strong>{{ loop.index }}</strong></td>
                    <td><code>{{ file.path }}</code></td>
                    <td>{{ file.commits | number_format }}</td>
                    <td style="color: #38a169;">+{{ file.lines_added | number_format }}</td>
                    <td style="color: #e53e3e;">-{{ file.lines_removed | number_format }}</td>
                    <td style="color: {% if file.net_change > 0 %}#38a169{% else %}#e53e3e{% endif %};">
                        {{ file.net_change | number_format }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>Project Health Insights</h2>
        <div class="overview">
            <div class="stat-card">
                <span class="stat-number">{{ ((files.top_by_commits | first).commits / statistics.total_commits * 100) | round(precision=1) }}%</span>
                <span class="stat-label">Hottest File Activity</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ (authors.list | length) }}</span>
                <span class="stat-label">Active Contributors</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ ((authors.list | first).percentage) | round(precision=0) }}%</span>
                <span class="stat-label">Top Contributor Share</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ files.top_by_commits | length }}</span>
                <span class="stat-label">Files Analyzed</span>
            </div>
        </div>

        <footer style="margin-top: 50px; padding-top: 20px; border-top: 1px solid #e2e8f0; text-align: center; color: #718096; font-size: 0.9em;">
            Generated with <strong>gstats template system</strong> â€¢ {{ repository.scan_timestamp | date(format="%Y-%m-%d %H:%M UTC") }}
        </footer>
    </div>
</body>
</html>